<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Professional Photography Gallery</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
        />
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
            rel="stylesheet"
        />
        <link rel="stylesheet" th:href="@{/css/style.css}" />
        <style>
            :root {
                --primary-color: #2c3e50;
                --secondary-color: #3498db;
                --accent-color: #e74c3c;
                --light-bg: #f8f9fa;
                --dark-text: #2c3e50;
            }

            body {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                font-family:
                    "Inter",
                    -apple-system,
                    BlinkMacSystemFont,
                    sans-serif;
            }

            .hero-section {
                background:
                    linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)),
                    url("/images/hero-bg.jpg");
                background-size: cover;
                background-position: center;
                color: white;
                padding: 4rem 0;
                margin-bottom: 2rem;
            }

            .hero-title {
                font-size: 3.5rem;
                font-weight: 300;
                letter-spacing: -0.02em;
            }

            .hero-subtitle {
                font-size: 1.3rem;
                opacity: 0.9;
                font-weight: 300;
            }

            .album-nav {
                background: white;
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
                padding: 1.5rem;
                margin-bottom: 2rem;
            }

            .album-card {
                background: white;
                border-radius: 15px;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
                transition: all 0.3s ease;
                overflow: hidden;
                margin-bottom: 1.5rem;
            }

            .album-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 15px 40px rgba(0, 0, 0, 0.12);
            }

            .album-cover {
                height: 250px;
                background: linear-gradient(45deg, #667eea, #764ba2);
                position: relative;
                overflow: hidden;
            }

            .album-cover img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                transition: transform 0.3s ease;
            }

            .album-card:hover .album-cover img {
                transform: scale(1.05);
            }

            .album-overlay {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: linear-gradient(
                    to bottom,
                    transparent 0%,
                    rgba(0, 0, 0, 0.7) 100%
                );
                display: flex;
                align-items: flex-end;
                padding: 1.5rem;
            }

            .album-info h3 {
                color: white;
                font-weight: 600;
                margin-bottom: 0.5rem;
            }

            .album-stats {
                color: rgba(255, 255, 255, 0.9);
                font-size: 0.9rem;
            }

            .photo-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                gap: 1.5rem;
                margin-top: 2rem;
            }

            .photo-card {
                background: white;
                border-radius: 15px;
                overflow: hidden;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
                transition: all 0.3s ease;
            }

            .photo-card:hover {
                transform: translateY(-3px);
                box-shadow: 0 12px 35px rgba(0, 0, 0, 0.12);
            }

            .photo-image {
                width: 100%;
                height: 250px;
                object-fit: cover;
            }

            .photo-info {
                padding: 1rem;
            }

            .workflow-badge {
                font-size: 0.75rem;
                padding: 0.25rem 0.75rem;
                border-radius: 20px;
                font-weight: 600;
            }

            .workflow-RAW {
                background: #6c757d;
                color: white;
            }
            .workflow-EDITED {
                background: #17a2b8;
                color: white;
            }
            .workflow-CLIENT_REVIEW {
                background: #ffc107;
                color: #212529;
            }
            .workflow-PUBLISHED {
                background: #28a745;
                color: white;
            }

            .featured-badge {
                background: #e74c3c;
                color: white;
                padding: 0.25rem 0.75rem;
                border-radius: 20px;
                font-size: 0.75rem;
                font-weight: 600;
            }

            .upload-section {
                background: white;
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
                padding: 2rem;
                margin-bottom: 2rem;
            }

            .btn-primary-custom {
                background: linear-gradient(45deg, #667eea, #764ba2);
                border: none;
                border-radius: 25px;
                padding: 0.75rem 2rem;
                font-weight: 600;
                transition: all 0.3s ease;
            }

            .btn-primary-custom:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
            }

            .section-header {
                text-align: center;
                margin-bottom: 3rem;
            }

            .section-title {
                font-size: 2.5rem;
                color: white;
                font-weight: 300;
                margin-bottom: 1rem;
            }

            .section-subtitle {
                color: rgba(255, 255, 255, 0.8);
                font-size: 1.1rem;
            }

            .quick-stats {
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(10px);
                border-radius: 15px;
                padding: 1.5rem;
                color: white;
                text-align: center;
            }

            .stat-number {
                font-size: 2rem;
                font-weight: 700;
                color: #f39c12;
            }

            @media (max-width: 768px) {
                .hero-title {
                    font-size: 2.5rem;
                }
                .photo-grid {
                    grid-template-columns: 1fr;
                }
            }
        </style>
    </head>
    <body>
        <!-- Hero Section -->
        <div class="hero-section">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-8">
                        <h1 class="hero-title">
                            Professional Photography Gallery
                        </h1>
                        <p class="hero-subtitle">
                            Capturing moments, creating memories
                        </p>
                    </div>
                    <div class="col-lg-4">
                        <div class="quick-stats">
                            <div class="stat-number" th:text="${photos.size()}">
                                0
                            </div>
                            <div>Total Photos</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container">
            <!-- Album Navigation -->
            <div class="album-nav">
                <div class="row align-items-center mb-3">
                    <div class="col-md-6">
                        <h4 class="mb-0">
                            <i class="bi bi-collection"></i> Gallery Navigation
                        </h4>
                    </div>
                    <div class="col-md-6 text-end">
                        <a href="/albums" class="btn btn-outline-primary">
                            <i class="bi bi-grid"></i> Manage Albums
                        </a>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-3">
                        <a href="/albums/clients" class="text-decoration-none">
                            <div
                                class="d-flex align-items-center p-3 bg-light rounded"
                            >
                                <i
                                    class="bi bi-people-fill fs-3 text-primary me-3"
                                ></i>
                                <div>
                                    <h6 class="mb-0">Clients</h6>
                                    <small class="text-muted"
                                        >Client Sessions</small
                                    >
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-3">
                        <a
                            href="/albums/collections"
                            class="text-decoration-none"
                        >
                            <div
                                class="d-flex align-items-center p-3 bg-light rounded"
                            >
                                <i
                                    class="bi bi-star-fill fs-3 text-warning me-3"
                                ></i>
                                <div>
                                    <h6 class="mb-0">Collections</h6>
                                    <small class="text-muted"
                                        >Curated Albums</small
                                    >
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-3">
                        <a
                            href="/albums/portfolio"
                            class="text-decoration-none"
                        >
                            <div
                                class="d-flex align-items-center p-3 bg-light rounded"
                            >
                                <i
                                    class="bi bi-trophy-fill fs-3 text-success me-3"
                                ></i>
                                <div>
                                    <h6 class="mb-0">Portfolio</h6>
                                    <small class="text-muted">Best Work</small>
                                </div>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-3">
                        <a
                            href="/albums/type/EVENT_TYPE"
                            class="text-decoration-none"
                        >
                            <div
                                class="d-flex align-items-center p-3 bg-light rounded"
                            >
                                <i
                                    class="bi bi-calendar-event fs-3 text-info me-3"
                                ></i>
                                <div>
                                    <h6 class="mb-0">Events</h6>
                                    <small class="text-muted"
                                        >By Category</small
                                    >
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Upload Section -->
            <div class="upload-section">
                <div class="row">
                    <div class="col-lg-6">
                        <h5>
                            <i class="bi bi-cloud-upload"></i> Upload New Photos
                        </h5>
                        <form
                            th:action="@{/upload}"
                            method="post"
                            enctype="multipart/form-data"
                            class="mt-3"
                        >
                            <div class="mb-3">
                                <input
                                    type="file"
                                    class="form-control"
                                    name="files"
                                    multiple
                                    required
                                    accept="image/*"
                                />
                            </div>
                            <button
                                type="submit"
                                class="btn btn-primary-custom"
                            >
                                <i class="bi bi-upload"></i> Upload Photos
                            </button>
                        </form>
                    </div>
                    <div class="col-lg-6">
                        <h5><i class="bi bi-search"></i> Search & Filter</h5>
                        <form action="/" method="get" class="mt-3">
                            <input
                                type="hidden"
                                name="sort"
                                th:value="${currentSort}"
                            />
                            <div class="input-group mb-3">
                                <input
                                    type="text"
                                    class="form-control"
                                    name="search"
                                    placeholder="Search photos..."
                                    th:value="${searchQuery}"
                                />
                                <button
                                    class="btn btn-outline-secondary"
                                    type="submit"
                                >
                                    <i class="bi bi-search"></i>
                                </button>
                            </div>
                        </form>

                        <select
                            class="form-select"
                            onchange="window.location.href='/?sort=' + this.value"
                        >
                            <option
                                value="uploadDate"
                                th:selected="${currentSort == 'uploadDate'}"
                            >
                                Latest Uploaded
                            </option>
                            <option
                                value="dateTaken"
                                th:selected="${currentSort == 'dateTaken'}"
                            >
                                Date Taken (Newest)
                            </option>
                            <option
                                value="dateTakenAsc"
                                th:selected="${currentSort == 'dateTakenAsc'}"
                            >
                                Date Taken (Oldest)
                            </option>
                            <option
                                value="camera"
                                th:selected="${currentSort == 'camera'}"
                            >
                                Camera Model
                            </option>
                            <option
                                value="withCamera"
                                th:selected="${currentSort == 'withCamera'}"
                            >
                                Has Camera Info
                            </option>
                            <option
                                value="withDateTaken"
                                th:selected="${currentSort == 'withDateTaken'}"
                            >
                                Has Date Taken
                            </option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Search Results Info -->
            <div th:if="${isSearchResult}" class="alert alert-info">
                <i class="bi bi-info-circle"></i>
                Showing search results for: "<strong
                    th:text="${searchQuery}"
                ></strong
                >"
                <a
                    th:href="@{/(sort=${currentSort})}"
                    class="btn btn-sm btn-outline-primary ms-2"
                    >Clear Search</a
                >
            </div>

            <!-- Success/Error Messages -->
            <div
                th:if="${message}"
                class="alert alert-success alert-dismissible"
            >
                <i class="bi bi-check-circle"></i>
                <span th:text="${message}"></span>
                <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="alert"
                ></button>
            </div>
        </div>

        <!-- Photo Grid Section -->
        <div class="container-fluid px-4">
            <div class="section-header" th:if="${photos.size() > 0}">
                <h2 class="section-title">Recent Photos</h2>
                <p class="section-subtitle">Latest additions to your gallery</p>
            </div>

            <div class="photo-grid" th:if="${photos.size() > 0}">
                <div th:each="photo : ${photos}" class="photo-card">
                    <div class="position-relative">
                        <img
                            th:src="@{/uploads/{f}(f=${photo.fileName})}"
                            th:alt="${photo.originalName}"
                            class="photo-image"
                            onerror="this.src='/images/placeholder.jpg'"
                        />

                        <!-- Workflow Status Badge -->
                        <div class="position-absolute top-0 start-0 m-2">
                            <span
                                class="workflow-badge"
                                th:classappend="'workflow-' + ${photo.workflowStatus}"
                                th:text="${photo.workflowStatus}"
                                >RAW</span
                            >
                        </div>

                        <!-- Featured Badge -->
                        <div
                            th:if="${photo.isFeatured}"
                            class="position-absolute top-0 end-0 m-2"
                        >
                            <span class="featured-badge">
                                <i class="bi bi-star-fill"></i> Featured
                            </span>
                        </div>
                    </div>

                    <div class="photo-info">
                        <div
                            class="d-flex justify-content-between align-items-start mb-2"
                        >
                            <h6 class="mb-0" th:text="${photo.originalName}">
                                Photo Name
                            </h6>
                            <div class="dropdown">
                                <button
                                    class="btn btn-sm btn-outline-secondary dropdown-toggle"
                                    data-bs-toggle="dropdown"
                                >
                                    <i class="bi bi-three-dots"></i>
                                </button>
                                <ul class="dropdown-menu">
                                    <li>
                                        <a
                                            class="dropdown-item"
                                            href="#"
                                            onclick="viewExif(this)"
                                            th:data-photo-id="${photo.id}"
                                        >
                                            <i class="bi bi-info-circle"></i>
                                            View EXIF
                                        </a>
                                    </li>
                                    <li>
                                        <a
                                            class="dropdown-item"
                                            href="#"
                                            onclick="setFeatured(this)"
                                            th:data-photo-id="${photo.id}"
                                        >
                                            <i class="bi bi-star"></i> Toggle
                                            Featured
                                        </a>
                                    </li>
                                    <li><hr class="dropdown-divider" /></li>
                                    <li>
                                        <a
                                            class="dropdown-item text-danger"
                                            href="#"
                                            onclick="deletePhoto(this)"
                                            th:data-photo-id="${photo.id}"
                                        >
                                            <i class="bi bi-trash"></i> Delete
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <div class="small text-muted">
                            <div th:if="${photo.camera}" class="mb-1">
                                <i class="bi bi-camera"></i>
                                <span th:text="${photo.camera}"></span>
                            </div>
                            <div th:if="${photo.dateTaken}" class="mb-1">
                                <i class="bi bi-calendar"></i>
                                <span
                                    th:text="${#temporals.format(photo.dateTaken, 'MMM dd, yyyy')}"
                                ></span>
                            </div>
                            <div
                                th:if="${photo.imageWidth != null and photo.imageHeight != null}"
                                class="mb-1"
                            >
                                <i class="bi bi-aspect-ratio"></i>
                                <span
                                    th:text="${photo.imageWidth} + ' Ã— ' + ${photo.imageHeight}"
                                ></span>
                            </div>
                            <div th:if="${photo.iso}" class="mb-1">
                                <i class="bi bi-speedometer"></i> ISO
                                <span th:text="${photo.iso}"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div th:if="${photos.size() == 0}" class="text-center py-5">
                <div class="mb-4">
                    <i class="bi bi-images display-1 text-muted"></i>
                </div>
                <h3 class="text-white mb-3">No photos yet</h3>
                <p class="text-muted mb-4">
                    Upload your first photo to get started with your
                    professional gallery!
                </p>
                <button
                    class="btn btn-primary-custom"
                    onclick="document.querySelector('input[type=file]').click()"
                >
                    <i class="bi bi-upload"></i> Upload Your First Photo
                </button>
            </div>
        </div>

        <!-- EXIF Modal -->
        <div class="modal fade" id="exifModal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Photo Details</h5>
                        <button
                            type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                        ></button>
                    </div>
                    <div class="modal-body" id="exifContent">
                        <!-- EXIF data will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            // View EXIF data
            function viewExif(element) {
                const photoId = element.dataset.photoId;
                fetch(`/photo/${photoId}/exif`)
                    .then((response) => response.json())
                    .then((data) => {
                        let html = '<div class="row">';

                        Object.keys(data).forEach((key) => {
                            if (data[key]) {
                                html += `
                                <div class="col-md-6 mb-2">
                                    <strong>${key.charAt(0).toUpperCase() + key.slice(1)}:</strong><br>
                                    <span class="text-muted">${data[key]}</span>
                                </div>
                            `;
                            }
                        });

                        html += "</div>";
                        document.getElementById("exifContent").innerHTML = html;
                        new bootstrap.Modal(
                            document.getElementById("exifModal"),
                        ).show();
                    });
            }

            // Delete photo
            function deletePhoto(element) {
                if (confirm("Are you sure you want to delete this photo?")) {
                    const photoId = element.dataset.photoId;

                    fetch(`/photo/${photoId}/delete`, {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/x-www-form-urlencoded",
                        },
                        body: "_method=DELETE",
                    }).then(() => {
                        location.reload();
                    });
                }
            }

            // Set featured photo
            function setFeatured(element) {
                const photoId = element.dataset.photoId;

                fetch(`/photo/${photoId}/toggle-featured`, {
                    method: "POST",
                }).then(() => {
                    location.reload();
                });
            }

            // Initialize tooltips
            document.addEventListener("DOMContentLoaded", function () {
                var tooltipTriggerList = [].slice.call(
                    document.querySelectorAll('[data-bs-toggle="tooltip"]'),
                );
                var tooltipList = tooltipTriggerList.map(
                    function (tooltipTriggerEl) {
                        return new bootstrap.Tooltip(tooltipTriggerEl);
                    },
                );
            });
        </script>
    </body>
</html>
